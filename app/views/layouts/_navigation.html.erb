<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="navbar-header">
    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
    <span class="sr-only"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    </button>
    <%= link_to I18n.t('brand.name'), root_path, class: 'navbar-brand' %>
  </div>
  <div class="collapse navbar-collapse">
    <ul class="nav navbar-nav navbar-right">
      <% if user_signed_in? %>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">
            <span class="label label-info">
              <i class="fa fa-users"></i>
              <span id="notificationsCount">
                <%= "#{current_user.notifications.unread_count}" %>
              </span>
            </span>
            <b class="caret"></b>
          </a>
          <ul class="dropdown-menu">
            <li>
              <%= link_to "Mark All As Read", mark_all_read_notifications_path(current_user.username), method: :post %>
              <%= link_to "Mark All As Unread", mark_all_unread_notifications_path(current_user.username), method: :post %>
            </li>
            <% current_user.notifications.each do |n| %>
              <li>
                <a href="javascript:;"> <%= render 'users/avatar', size: :tiny, user: n.sender %> <%= "#{n.sender.username.titleize} commented on #{n.user.username.titleize}'s #{n.notifyable_type}" %> </a>
              </li>
              <li> 
                <%= link_to "Mark As Read", mark_as_read_notification_path(current_user.username, n.id), method: :post %>
                <%#= link_to "Stop Notifications", opt_out_notification_path(current_user.username, n.notifyable_id, type: n.notifyable_type), method: :post %>
              </li>
            <% end %>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">
            <%= render 'users/avatar', size: :tiny %>
            <b class="caret"></b>
          </a>
          <ul class="dropdown-menu">
            <% if current_user.is_admin? %>
              <li>
                <%= link_to I18n.t('admin.link'), rails_admin_path, data: {"no-turbolink" => true} %>
              </li>
            <% end %> <!-- END if current_user.is_admin? -->
            <li>
              <%= link_to I18n.t('account.posts.link'), posts_path %>
            </li>
            <li>
              <%= link_to "Categories", topics_path %>
            </li>
            <li>
              <%= link_to I18n.t('account.profile.link'), profile_page_path(current_user.username) %>
            </li>
            <li>
              <%= link_to I18n.t('account.messages.link'), :conversations %>
            </li>
            <li>
              <%= link_to I18n.t('account.edit.link'), edit_user_registration_path %>
            </li>
            <li>
              <%= link_to "Activity Feed", activities_path %>
            </li>
            <li>
              <%= link_to "My Favorites", favorites_path(current_user.username) %>
            </li>
            <li>
              <%= link_to I18n.t('auth.logout.link'), destroy_user_session_path, rel: :nofollow %>
            </li>
          </ul> <!-- END dropdown-menu -->
        </li> <!-- END dropdown -->
      <% end %> <!-- END if user_signedin? -->
      <% unless user_signed_in? %>
        <li>
          <%= link_to I18n.t('auth.signup.link'), new_user_registration_path %>
        </li>
        <li>
          <%= link_to I18n.t('auth.login.link'), new_user_session_path %>
        </li>
      <% end %> <!-- END unless user_signedin? < Shows if no user is signed in > -->
    </ul> <!-- END navbar-nav ul -->
  </div> <!-- END navbar-collapse -->
</nav> <!-- END navigation menu -->
